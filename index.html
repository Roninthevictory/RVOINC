<!--
📜 LICENSE & USAGE TERMS
───────────────────────────────────────────────
Project: RVO INC — Official Website
Version: Current Production Release
Effective Date: October 15, 2025
Copyright © 2025 RVO INC. All Rights Reserved.

This project and all associated files, including but not limited to HTML, CSS,
JavaScript, images, server scripts, and related digital assets, are the exclusive
intellectual property of RVO INC and its authorized contributors.

───────────────────────────────────────────────
PERMITTED USE
───────────────────────────────────────────────
You are permitted to:
- View and interact with this website through approved public access points
- Reference the website for educational or informational purposes (non-commercial)
- Use Firebase services **only** under Firebase’s own provided API and terms of service,
  as RVO INC does not own, operate, or license the Firebase API in any capacity

───────────────────────────────────────────────
RESTRICTED USE
───────────────────────────────────────────────
Without prior written consent from RVO INC, you are strictly prohibited from:
- Copying, duplicating, or redistributing any source code, assets, or data
- Reverse-engineering or decompiling the site’s structure, backend, or integrated systems
- Cloning, replicating, or reusing the website’s design, layout, or user interface elements
- Removing, altering, or obscuring copyright notices or proprietary disclaimers
- Using this project or any portion thereof for commercial gain
- Uploading, hosting, or distributing modified or derivative versions
- Accessing or interacting with internal or private APIs, databases, or endpoints

───────────────────────────────────────────────
OWNERSHIP & COPYRIGHT
───────────────────────────────────────────────
All content, source code, and design elements are the property of RVO INC.
Unauthorized reproduction or redistribution of this material constitutes
a violation of international copyright laws and will result in legal action,
including but not limited to DMCA takedown requests, cease-and-desist orders,
and potential civil litigation.

───────────────────────────────────────────────
LIABILITY & WARRANTY DISCLAIMER
───────────────────────────────────────────────
This project is provided “as is,” without any express or implied warranties,
including but not limited to implied warranties of merchantability,
fitness for a particular purpose, or non-infringement.

RVO INC assumes no responsibility for any damages, losses, or claims arising
from the use or inability to use this website, its components, or third-party
integrations such as Firebase.

───────────────────────────────────────────────
CONTACT & PERMISSIONS
───────────────────────────────────────────────
To request written authorization for reuse, redistribution, or licensing,
please contact RVO INC via official communication channels or submit a
formal inquiry through the company’s verified contact portal.

───────────────────────────────────────────────
End of License
-->


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RVO Inc. | Elite Development and Coding Services</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Stripe SDK (Included in original, keeping it) -->
    <script src="https://js.stripe.com/v3/"></script>
    <style>
        /* Custom styles for a modern, tech-focused look */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0d1117; /* Dark background */
            color: #c9d1d9; /* Light text */
        }
        /* UPDATED: Red/Crimson Gradient */
        .text-gradient {
            background-image: linear-gradient(45deg, #dc143c, #ff6347); /* Crimson to Tomato Red */
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .card-bg {
            background-color: #161b22; /* Slightly lighter dark background for cards */
            border: 1px solid #30363d;
        }
        /* UPDATED: Red hover color */
        .nav-link:hover {
            color: #ff6347; /* Tomato Red for hover */
            text-shadow: 0 0 5px rgba(255, 99, 71, 0.5);
        }
        /* New: Style for the active navigation link */
        .nav-link.active {
            color: #ff6347; /* Tomato Red for active state */
            font-weight: 600;
        }
        /* Style for buttons to hide default Tailwind focus ring */
        .focus\:ring-red-500:focus {
             box-shadow: 0 0 0 2px rgba(239, 68, 68, 0.5);
        }
    </style>
</head>
<body>

    <!-- Navigation Bar -->
    <nav class="sticky top-0 z-50 card-bg shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex-shrink-0">
                    <span class="text-2xl font-bold text-gradient">RVO Inc.</span>
                </div>
                <div class="hidden md:flex space-x-8">
                    <!-- Buttons now use data-target for page switching -->
                    <button class="nav-link text-sm font-medium transition duration-150" data-target="home">Home</button>
                    <button class="nav-link text-sm font-medium transition duration-150" data-target="services">Services</button>
                    <button class="nav-link text-sm font-medium transition duration-150" data-target="subscriptions">Subscriptions</button>
                    <button class="nav-link text-sm font-medium transition duration-150" data-target="affiliates">Affiliates</button>
                    <button class="nav-link text-sm font-medium transition duration-150" data-target="partners">Partners</button>
                </div>
                <!-- Auth/Logout Button Placeholder -->
                <div class="flex items-center space-x-4">
                    <button id="auth-status-btn" class="px-3 py-1.5 text-sm font-semibold rounded-xl bg-red-700 hover:bg-red-600 text-white transition duration-300 shadow-xl shadow-red-900/50 hidden">
                        Sign In
                    </button>
                    <button id="logout-btn" class="hidden p-2 rounded-lg hover:bg-red-700 transition duration-150" aria-label="Logout">
                        <i data-lucide="log-out" class="w-6 h-6 text-white"></i>
                    </button>
                </div>
                <!-- Mobile Menu Button (Lucide Menu Icon) -->
                <button id="mobile-menu-btn" class="md:hidden p-2 rounded-lg hover:bg-gray-700 transition duration-150" aria-label="Toggle menu">
                    <i data-lucide="menu" class="w-6 h-6 text-white"></i>
                </button>
            </div>
        </div>
        <!-- Mobile Menu (Hidden by default) -->
        <div id="mobile-menu" class="hidden md:hidden card-bg shadow-xl">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3 flex flex-col items-center">
                <button class="nav-link text-base py-2 w-full text-center transition duration-150 border-b border-gray-700" data-target="home">Home</button>
                <button class="nav-link text-base py-2 w-full text-center transition duration-150 border-b border-gray-700" data-target="services">Services</button>
                <button class="nav-link text-base py-2 w-full text-center transition duration-150 border-b border-gray-700" data-target="subscriptions">Subscriptions</button>
                <button class="nav-link text-base py-2 w-full text-center transition duration-150 border-b border-gray-700" data-target="affiliates">Affiliates</button>
                <button class="nav-link text-base py-2 w-full text-center transition duration-150 border-b border-gray-700" data-target="partners">Partners</button>
            </div>
        </div>
    </nav>

    <!-- Main Content Sections Container -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">

        <!-- 1. Home Section - Initially shown -->
        <section id="home" class="pt-8 pb-20 text-center content-section">
            <h1 class="text-4xl sm:text-6xl font-extrabold tracking-tight mb-4 leading-snug">
                Building <span class="text-gradient">Tomorrow's Systems</span>, Today.
            </h1>
            <p class="mt-4 text-xl text-gray-400 max-w-3xl mx-auto">
                RVO Inc. specializes in cutting-edge development services. From static websites and robust backend systems to complex game clients and multilingual coding solutions, we are your comprehensive development partner.
            </p>
            <div class="mt-10 flex justify-center space-x-4">
                <!-- Buttons now use data-target for switching -->
                <button class="navigate-link px-8 py-3 text-lg font-semibold rounded-xl bg-red-700 hover:bg-red-600 text-white transition duration-300 shadow-xl shadow-red-900/50" data-target="services">Explore Services</button>
                <button class="navigate-link px-8 py-3 text-lg font-semibold rounded-xl card-bg hover:bg-gray-700 transition duration-300" data-target="subscriptions">View Plans</button>
            </div>
        </section>

        <!-- 2. Subscriptions Section - Initially hidden -->
        <section id="subscriptions" class="py-20 content-section hidden">
            <h2 class="text-3xl sm:text-4xl font-bold text-center mb-12">Flexible <span class="text-gradient">Development Subscriptions</span></h2>
            <div id="subscription-plans" class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <!-- Content generated by JS -->
            </div>
        </section>

        <!-- 3. Services Section - Initially hidden -->
        <section id="services" class="py-20 content-section hidden">
            <h2 class="text-3xl sm:text-4xl font-bold text-center mb-12">Our Comprehensive <span class="text-gradient">Coding Capabilities</span></h2>

            <!-- Service Search and Filter -->
            <div class="flex flex-col sm:flex-row gap-4 mb-10 card-bg p-6 rounded-xl shadow-lg">
                <!-- UPDATED: Focus ring/border to red-500 -->
                <input type="text" id="service-search" placeholder="Search services (e.g., React, Python, Unity)" class="flex-grow p-3 rounded-lg bg-gray-700 border border-gray-600 text-white placeholder-gray-400 focus:ring-red-500 focus:border-red-500">
                <select id="service-filter" class="p-3 rounded-lg bg-gray-700 border border-gray-600 text-white focus:ring-red-500 focus:border-red-500">
                    <option value="all">Filter by Category</option>
                    <!-- Options populated by JS -->
                </select>
            </div>

            <!-- Service List -->
            <div id="service-list" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Content generated by JS -->
            </div>
            
            <p id="no-results" class="hidden text-center text-xl text-gray-400 mt-10">No development services found matching your criteria.</p>

        </section>

        <!-- 4. Affiliates Section - Initially hidden -->
        <section id="affiliates" class="py-20 content-section hidden">
            <h2 class="text-3xl sm:text-4xl font-bold text-center mb-12">Join Our <span class="text-gradient">Affiliate Network</span></h2>
            <div class="card-bg p-8 rounded-xl shadow-lg max-w-4xl mx-auto text-center">
                <p class="text-lg text-gray-300 mb-6">
                    Refer clients to RVO Inc. and earn a commission on every successful development project or subscription sign-up. We provide detailed tracking and competitive payouts for referring top-tier coding work.
                </p>
                <!-- Retaining green for 'Sign Up' button for contrast -->
                <button id="open-affiliate-modal" class="inline-flex items-center px-6 py-3 text-lg font-semibold rounded-xl bg-green-600 hover:bg-green-500 text-white transition duration-300">
                    <i data-lucide="zap" class="w-5 h-5 mr-2"></i> Sign Up Today
                </button>
            </div>
        </section>

        <!-- 5. Partners Section - Initially hidden -->
        <section id="partners" class="py-20 content-section hidden">
            <h2 class="text-3xl sm:text-4xl font-bold text-center mb-12">Our <span class="text-gradient">Technology Partners</span></h2>
            <div class="flex flex-wrap justify-center items-center gap-8 card-bg p-8 rounded-xl shadow-lg">
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="cloud" class="w-6 h-6 mr-1 text-blue-500"></i> AWS
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="database" class="w-6 h-6 mr-1 text-orange-500"></i> Firebase
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="code" class="w-6 h-6 mr-1 text-green-500"></i> GitHub
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="layout-grid" class="w-6 h-6 mr-1 text-red-500"></i> React
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="gamepad" class="w-6 h-6 mr-1 text-purple-500"></i> Unity
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="globe" class="w-6 h-6 mr-1 text-cyan-400"></i> Azure
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="server" class="w-6 h-6 mr-1 text-amber-500"></i> GCP
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="container" class="w-6 h-6 mr-1 text-blue-400"></i> Docker
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="activity" class="w-6 h-6 mr-1 text-violet-500"></i> Kubernetes
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="feather" class="w-6 h-6 mr-1 text-sky-500"></i> Tailwind
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="zap" class="w-6 h-6 mr-1 text-green-400"></i> Next.js
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="package" class="w-6 h-6 mr-1 text-red-600"></i> Node.js
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="settings" class="w-6 h-6 mr-1 text-zinc-400"></i> Express
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="type" class="w-6 h-6 mr-1 text-blue-600"></i> TypeScript
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="table" class="w-6 h-6 mr-1 text-indigo-500"></i> PostgreSQL
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="refresh-cw" class="w-6 h-6 mr-1 text-red-700"></i> Redis
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="infinity" class="w-6 h-6 mr-1 text-emerald-500"></i> MongoDB
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="git-branch" class="w-6 h-6 mr-1 text-orange-500"></i> GitLab
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="check-square" class="w-6 h-6 mr-1 text-blue-500"></i> Jest
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="speech" class="w-6 h-6 mr-1 text-pink-500"></i> Slack
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="shield" class="w-6 h-6 mr-1 text-lime-500"></i> Cloudflare
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="bar-chart-2" class="w-6 h-6 mr-1 text-fuchsia-500"></i> Vercel
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="monitor" class="w-6 h-6 mr-1 text-gray-500"></i> DigitalOcean
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="lock" class="w-6 h-6 mr-1 text-yellow-500"></i> Auth0
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="bug" class="w-6 h-6 mr-1 text-red-400"></i> Sentry
                </div>
                
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="layout" class="w-6 h-6 mr-1 text-green-700"></i> Vue.js
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="star" class="w-6 h-6 mr-1 text-orange-400"></i> Angular
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="box" class="w-6 h-6 mr-1 text-pink-700"></i> Svelte
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="tablet" class="w-6 h-6 mr-1 text-indigo-300"></i> Bootstrap
                </div>

                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="python" class="w-6 h-6 mr-1 text-yellow-300"></i> Python
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="coffee" class="w-6 h-6 mr-1 text-orange-700"></i> Java
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="send" class="w-6 h-6 mr-1 text-blue-700"></i> Go
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="leaf" class="w-6 h-6 mr-1 text-lime-400"></i> Django
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="gem" class="w-6 h-6 mr-1 text-red-500"></i> Ruby
                </div>

                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="mail" class="w-6 h-6 mr-1 text-sky-400"></i> SendGrid
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="message-circle" class="w-6 h-6 mr-1 text-pink-500"></i> Twilio
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="wallet" class="w-6 h-6 mr-1 text-purple-600"></i> Stripe
                </div>

                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="terminal" class="w-6 h-6 mr-1 text-teal-400"></i> Webpack
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="wrench" class="w-6 h-6 mr-1 text-gray-700"></i> Babel
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="key" class="w-6 h-6 mr-1 text-green-500"></i> OKTA
                </div>

                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="trending-up" class="w-6 h-6 mr-1 text-cyan-600"></i> Amplitude
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="pie-chart" class="w-6 h-6 mr-1 text-red-400"></i> Mixpanel
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="activity-square" class="w-6 h-6 mr-1 text-indigo-400"></i> Datadog
                </div>

                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="apple" class="w-6 h-6 mr-1 text-gray-400"></i> iOS
                </div>
                <div class="w-24 h-10 flex justify-center items-center text-xl font-bold text-white opacity-80 hover:opacity-100 transition duration-300">
                    <i data-lucide="chrome" class="w-6 h-6 mr-1 text-green-300"></i> Android
                </div>
            </div>
        </section>
        
    </main>
    
    <!-- Auth Modal -->
    <div id="auth-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
        <div class="card-bg p-8 rounded-xl shadow-2xl w-full max-w-md mx-4">
            <div class="flex justify-between items-center mb-6">
                <h3 id="auth-title" class="text-2xl font-bold text-white">Sign In</h3>
                <button id="close-modal" class="text-gray-400 hover:text-white">
                    <i data-lucide="x" class="w-6 h-6"></i>
                </button>
            </div>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-1">Email</label>
                    <input type="email" id="auth-email" class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 text-white placeholder-gray-400 focus:ring-red-500 focus:border-red-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-1">Password</label>
                    <input type="password" id="auth-password" class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 text-white focus:ring-red-500 focus:border-red-500">
                </div>
                <button id="auth-submit" class="w-full py-3 font-semibold rounded-xl bg-red-700 hover:bg-red-600 text-white transition duration-300">Sign In</button>
                <button id="auth-toggle" class="w-full py-2 text-sm text-gray-400 hover:text-white">Don't have an account? Sign Up</button>
                <div class="relative">
                    <div class="absolute inset-0 flex items-center">
                        <div class="w-full border-t border-gray-600"></div>
                    </div>
                    <div class="relative flex justify-center text-sm">
                        <span class="px-2 bg-gray-800 text-gray-400">Or</span>
                    </div>
                </div>
                <!-- Google Sign-in Button -->
                <button id="google-signin" class="w-full py-3 font-semibold rounded-xl bg-white hover:bg-gray-100 text-gray-900 transition duration-300 flex items-center justify-center">
                    <svg class="w-5 h-5 mr-2" viewBox="0 0 24 24">
                        <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                        <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                        <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                        <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                    </svg>
                    Sign in with Google
                </button>
            </div>
            <div id="auth-error" class="mt-4 text-red-500 text-sm hidden"></div>
        </div>
    </div>

    <!-- Affiliate Registration Modal -->
    <div id="affiliate-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="card-bg p-8 rounded-xl shadow-2xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-white">Join Our Affiliate Program</h3>
                <button id="close-affiliate-modal" class="text-gray-400 hover:text-white">
                    <i data-lucide="x" class="w-6 h-6"></i>
                </button>
            </div>
            
            <form id="affiliate-form" class="space-y-4">
                <!-- Preferred Name -->
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-1">Preferred Name <span class="text-red-500">*</span></label>
                    <input type="text" id="affiliate-name" required class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 text-white placeholder-gray-400 focus:ring-red-500 focus:border-red-500" placeholder="Your preferred name">
                </div>

                <!-- Discord Name -->
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-1">Discord Name <span class="text-red-500">*</span></label>
                    <input type="text" id="affiliate-discord-name" required class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 text-white placeholder-gray-400 focus:ring-red-500 focus:border-red-500" placeholder="username#0000 or @username">
                </div>

                <!-- Discord ID -->
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-1">Discord ID <span class="text-red-500">*</span></label>
                    <details class="mb-2 text-xs text-gray-400">
                        <summary class="cursor-pointer hover:text-gray-300 inline-flex items-center gap-1">
                            <i data-lucide="help-circle" class="w-3 h-3"></i> How to find your Discord ID
                        </summary>
                        <div class="mt-2 p-3 bg-gray-800 rounded-lg space-y-2">
                            <p><strong class="text-white">On Desktop/PC:</strong></p>
                            <ol class="list-decimal ml-4 space-y-1">
                                <li>Open Discord and go to User Settings (gear icon)</li>
                                <li>Go to Advanced and enable "Developer Mode"</li>
                                <li>Right-click your username anywhere and select "Copy User ID"</li>
                            </ol>
                            <p class="mt-2"><strong class="text-white">On Mobile:</strong></p>
                            <ol class="list-decimal ml-4 space-y-1">
                                <li>Tap your profile picture in the bottom right</li>
                                <li>Tap the three dots menu and select "Settings"</li>
                                <li>Go to Behavior > Enable "Developer Mode"</li>
                                <li>Go back, tap your profile again, and select "Copy User ID"</li>
                            </ol>
                            <p class="mt-2"><strong class="text-white">On Browser:</strong></p>
                            <ol class="list-decimal ml-4 space-y-1">
                                <li>Log into Discord via browser</li>
                                <li>Click the gear icon for User Settings</li>
                                <li>Go to Advanced and enable "Developer Mode"</li>
                                <li>Right-click your username and select "Copy User ID"</li>
                            </ol>
                            <p class="mt-2 text-yellow-400">Your Discord ID is a long number (e.g., 123456789012345678)</p>
                        </div>
                    </details>
                    <input type="text" id="affiliate-discord-id" required pattern="[0-9]{17,19}" class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 text-white placeholder-gray-400 focus:ring-red-500 focus:border-red-500" placeholder="123456789012345678">
                    <small class="text-gray-500">Numbers only, 17-19 digits</small>
                </div>

                <!-- Email -->
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-1">Email Address <span class="text-red-500">*</span></label>
                    <input type="email" id="affiliate-email" required class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 text-white placeholder-gray-400 focus:ring-red-500 focus:border-red-500" placeholder="your@email.com">
                </div>

                <!-- Phone (Optional) -->
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-1">Phone Number <span class="text-gray-500">(Optional)</span></label>
                    <input type="tel" id="affiliate-phone" class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 text-white placeholder-gray-400 focus:ring-red-500 focus:border-red-500" placeholder="+1 (555) 123-4567">
                </div>

                <!-- Company Name (Optional) -->
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-1">Company Name <span class="text-gray-500">(Optional)</span></label>
                    <input type="text" id="affiliate-company" class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 text-white placeholder-gray-400 focus:ring-red-500 focus:border-red-500" placeholder="Your Company Inc.">
                </div>

                <!-- Custom Code -->
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-1">Desired Affiliate Code <span class="text-red-500">*</span></label>
                    <input type="text" id="affiliate-code" required pattern="[a-z\-]{1,14}" class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 text-white placeholder-gray-400 focus:ring-red-500 focus:border-red-500" placeholder="my-awesome-code" maxlength="14">
                    <small class="text-gray-500">Lowercase letters and hyphens (-) only. Max 14 characters. No underscores, dots, or other special characters.</small>
                </div>

                <!-- Social Followers -->
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-1">Main Social Media Followers <span class="text-red-500">*</span></label>
                    <select id="affiliate-followers" required class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 text-white focus:ring-red-500 focus:border-red-500">
                        <option value="">Select follower range</option>
                        <option value="0-1000">0 - 1,000</option>
                        <option value="1000-5000">1,000 - 5,000</option>
                        <option value="5000-10000">5,000 - 10,000</option>
                        <option value="10000-50000">10,000 - 50,000</option>
                        <option value="50000-100000">50,000 - 100,000</option>
                        <option value="100000+">100,000+</option>
                    </select>
                </div>

                <!-- Primary Platform -->
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-1">Primary Promotion Platform <span class="text-red-500">*</span></label>
                    <select id="affiliate-platform" required class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 text-white focus:ring-red-500 focus:border-red-500">
                        <option value="">Select platform</option>
                        <option value="YouTube">YouTube</option>
                        <option value="Twitter/X">Twitter/X</option>
                        <option value="Instagram">Instagram</option>
                        <option value="TikTok">TikTok</option>
                        <option value="Discord">Discord Community</option>
                        <option value="Twitch">Twitch</option>
                        <option value="LinkedIn">LinkedIn</option>
                        <option value="Blog/Website">Blog/Website</option>
                        <option value="Other">Other</option>
                    </select>
                </div>

                <!-- Social Profile Link -->
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-1">Link to Main Social Profile <span class="text-red-500">*</span></label>
                    <input type="url" id="affiliate-profile-link" required class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 text-white placeholder-gray-400 focus:ring-red-500 focus:border-red-500" placeholder="https://youtube.com/@yourchannel">
                </div>

                <!-- Expected Monthly Referrals -->
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-1">Expected Monthly Referrals <span class="text-red-500">*</span></label>
                    <select id="affiliate-referrals" required class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 text-white focus:ring-red-500 focus:border-red-500">
                        <option value="">Select expected referrals</option>
                        <option value="1-5">1 - 5</option>
                        <option value="5-10">5 - 10</option>
                        <option value="10-25">10 - 25</option>
                        <option value="25-50">25 - 50</option>
                        <option value="50+">50+</option>
                    </select>
                </div>

                <!-- Notification Preference -->
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-1">Where should we notify you about updates? <span class="text-red-500">*</span></label>
                    <select id="affiliate-notification" required class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 text-white focus:ring-red-500 focus:border-red-500">
                        <option value="">Select notification preference</option>
                        <option value="Email">Email</option>
                        <option value="Discord">Discord</option>
                        <option value="Both">Both Email & Discord</option>
                    </select>
                </div>

                <!-- Geographic Focus -->
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-1">Primary Geographic Focus <span class="text-red-500">*</span></label>
                    <input type="text" id="affiliate-geo" required class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 text-white placeholder-gray-400 focus:ring-red-500 focus:border-red-500" placeholder="e.g., North America, Europe, Global">
                </div>

                <!-- Experience Level -->
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-1">Your Experience with Affiliate Marketing <span class="text-red-500">*</span></label>
                    <select id="affiliate-experience" required class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 text-white focus:ring-red-500 focus:border-red-500">
                        <option value="">Select your experience level</option>
                        <option value="Beginner">Beginner (New to affiliate marketing)</option>
                        <option value="Intermediate">Intermediate (Some experience)</option>
                        <option value="Advanced">Advanced (Professional affiliate marketer)</option>
                    </select>
                </div>

                <!-- Compliance Checkbox -->
                <div class="flex items-start">
                    <input type="checkbox" id="affiliate-compliance" required class="mt-1 mr-2 h-4 w-4 rounded border-gray-600 bg-gray-700 text-red-600 focus:ring-red-500">
                    <label for="affiliate-compliance" class="text-sm text-gray-300">
                        I confirm that I will comply with all RVO Inc. affiliate program guidelines and accurately represent our services. <span class="text-red-500">*</span>
                    </label>
                </div>

                <!-- Error Message -->
                <div id="affiliate-error" class="hidden text-red-500 text-sm p-3 bg-red-900/20 rounded-lg"></div>

                <!-- Submit Button -->
                <button type="submit" id="affiliate-submit" class="w-full py-3 font-semibold rounded-xl bg-red-700 hover:bg-red-600 text-white transition duration-300">
                    Submit Application
                </button>
            </form>
        </div>
    </div>

    <!-- Success Popup -->
    <div id="success-popup" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="card-bg p-8 rounded-xl shadow-2xl w-full max-w-md mx-4 text-center">
            <div class="mb-4 flex justify-center">
                <div class="w-16 h-16 rounded-full bg-green-500/20 flex items-center justify-center">
                    <i data-lucide="check-circle" class="w-10 h-10 text-green-500"></i>
                </div>
            </div>
            <h3 class="text-2xl font-bold text-white mb-4">Application Submitted!</h3>
            <p class="text-gray-300 mb-6">
                Thank you for applying to our affiliate program. Your application has been received and is under review.
            </p>
            <p class="text-sm text-gray-400 mb-6">
                It can take about <span class="text-red-400 font-semibold">12-48 hours</span> for us to register your code. You will receive an email confirmation once your application is approved.
            </p>
            <button id="close-success-popup" class="px-6 py-3 font-semibold rounded-xl bg-red-700 hover:bg-red-600 text-white transition duration-300">
                Got it!
            </button>
        </div>
    </div>

    <!-- Footer -->
    <footer class="card-bg mt-16 py-8 border-t border-gray-800">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center text-sm text-gray-500">
            <p>&copy; 2025 RVO Inc. All Rights Reserved. Specializing in High-Quality Software Development.</p>
        </div>
    </footer>

    <!-- REFACTORED SCRIPT using Firebase V11 Modular SDK and Canvas Globals -->
    <script type="module">
        // Firebase V11 Modular Imports
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { 
            getAuth, 
            signInAnonymously, 
            signInWithCustomToken, 
            onAuthStateChanged,
            signInWithEmailAndPassword,
            createUserWithEmailAndPassword,
            GoogleAuthProvider,
            signInWithPopup, 
            getRedirectResult, 
            signOut 
        } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        // Import firestore is not needed as data is static for this example, but keep the auth setup.

        // ----------------------------------------------------------------------
        // CRITICAL FIX: HARDCODING FIREBASE CONFIG FOR GOOGLE SITES EMBEDS
        // ----------------------------------------------------------------------
        const FIREBASE_CONFIG = {
            // FIREBASE CONFIGURATION PROVIDED BY USER (Placeholder/Fallback):
            apiKey: "AIzaSyATMtyx9nuwIcv-OWODFIQA4NOtDzqTqJc",
            authDomain: "rvoincwebsite.firebaseapp.com",
            projectId: "rvoincwebsite",
            storageBucket: "rvoincwebsite.firebasestorage.app",
            messagingSenderId: "675340459793",
            appId: "1:675340459793:web:89dd0ecce1f1c3ee1336b0"
        };
        
        // This logic ensures we use the canvas global if available, but falls back to the hardcoded config
        const firebaseConfig = (() => {
            if (typeof __firebase_config !== 'undefined' && __firebase_config) {
                try {
                    // This block is used in the Canvas environment
                    return JSON.parse(__firebase_config);
                } catch (e) {
                    console.error("Failed to parse __firebase_config, using hardcoded config.");
                }
            }
            // This block is used when embedded outside of Canvas (like Google Sites)
            if (FIREBASE_CONFIG.apiKey.startsWith("AIzaSyA")) {
                console.warn("Using placeholder Firebase config. Authentication will work but only if you replace the API key with your actual one.");
            }
            return FIREBASE_CONFIG;
        })();
        
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
        // ----------------------------------------------------------------------

        let app = null;
        let auth = null;
        let isLoggedIn = false;
        let currentUser = null;
        let isFirebaseReady = false; // Flag to check if Firebase auth has completed its initial check

        // DOM elements
        const authModal = document.getElementById('auth-modal');
        const authStatusBtn = document.getElementById('auth-status-btn');
        const logoutBtn = document.getElementById('logout-btn');
        const authTitle = document.getElementById('auth-title');
        const authSubmitBtn = document.getElementById('auth-submit');
        const authToggleBtn = document.getElementById('auth-toggle');
        const authErrorDiv = document.getElementById('auth-error');
        
        let isSigningUp = false;

        // Function to set up Firebase and perform initial authentication
        async function setupFirebase() {
            if (!firebaseConfig || !firebaseConfig.apiKey || firebaseConfig.apiKey.startsWith("AIzaSyA")) {
                console.warn("Firebase configuration is potentially incomplete. Auth will proceed with caution.");
            }

            try {
                app = initializeApp(firebaseConfig);
                auth = getAuth(app);
                
                // --- 1. HANDLE REDIRECT RESULT (for Google Auth) ---
                const result = await getRedirectResult(auth);
                if (result) {
                    console.log("SUCCESS: User returned after Google redirect sign-in:", result.user.email);
                    hideAuthModal();
                }

                // Initial sign-in with custom token or anonymously
                if (initialAuthToken) {
                    await signInWithCustomToken(auth, initialAuthToken).catch(e => console.error("Custom token sign-in failed:", e));
                } else {
                    await signInAnonymously(auth).catch(e => console.error("Anonymous sign-in failed:", e));
                }
                
                // Set up Auth State Listener (Modular V11 syntax)
                onAuthStateChanged(auth, (user) => {
                    isLoggedIn = !!user && !user.isAnonymous; // Consider only non-anonymous users as 'logged in' for full site features
                    currentUser = user;
                    isFirebaseReady = true; // Auth check completed
                    updateUIForAuthState();
                    // CRITICAL: Re-render dynamic content (buttons) on auth state change
                    renderServices(allServices);
                    renderSubscriptions(subscriptionPlans);
                    console.log("Firebase Auth State Changed. User is logged in:", isLoggedIn);
                });

            } catch (error) {
                console.error("CRITICAL ERROR: Firebase initialization or initial sign-in failed:", error);
                isFirebaseReady = true;
            }
        }

        // --------------------------------------------------------------------------------
        // UI AND AUTHENTICATION HANDLERS
        // --------------------------------------------------------------------------------
        
        function updateUIForAuthState() {
            authStatusBtn.classList.remove('hidden'); // Always show the general button

            if (isLoggedIn) {
                // User is authenticated (Email/Google)
                authStatusBtn.textContent = currentUser.email ? currentUser.email.split('@')[0] : 'Profile';
                authStatusBtn.classList.remove('bg-red-700', 'hover:bg-red-600', 'shadow-red-900/50');
                authStatusBtn.classList.add('card-bg', 'border', 'border-gray-700');
                authStatusBtn.removeEventListener('click', showAuthModal);
                authStatusBtn.addEventListener('click', () => navigateTo('subscriptions')); // Example: Go to profile/subscriptions
                logoutBtn.classList.remove('hidden');
            } else {
                // User is anonymous or logged out
                authStatusBtn.textContent = 'Sign In';
                authStatusBtn.classList.remove('card-bg', 'border', 'border-gray-700');
                authStatusBtn.classList.add('bg-red-700', 'hover:bg-red-600', 'shadow-red-900/50');
                authStatusBtn.addEventListener('click', showAuthModal);
                logoutBtn.classList.add('hidden');
            }
        }

        function showAuthModal(initialError = null) {
            authModal.classList.remove('hidden');
            // Ensure the modal starts in Sign In mode
            isSigningUp = false;
            updateAuthModalUI();
            // Clear general error when modal opens
            authErrorDiv.textContent = '';
            authErrorDiv.classList.remove('text-green-500');
            authErrorDiv.classList.add('text-red-500');

            if (initialError) {
                authErrorDiv.textContent = initialError;
                authErrorDiv.classList.remove('hidden');
            } else {
                authErrorDiv.classList.add('hidden');
            }
        }

        function hideAuthModal() {
            authModal.classList.add('hidden');
        }

        function updateAuthModalUI() {
            authTitle.textContent = isSigningUp ? 'Sign Up' : 'Sign In';
            authSubmitBtn.textContent = isSigningUp ? 'Create Account' : 'Sign In';
            authToggleBtn.textContent = isSigningUp ? 'Already have an account? Sign In' : "Don't have an account? Sign Up";
        }
        
        async function handleAuthAction() {
            if (!auth) {
                showAuthError("Firebase is not initialized.");
                return;
            }

            const email = document.getElementById('auth-email').value;
            const password = document.getElementById('auth-password').value;
            authErrorDiv.classList.add('hidden');
            
            if (!email || !password) {
                showAuthError("Please enter both email and password.");
                return;
            }

            try {
                if (isSigningUp) {
                    await createUserWithEmailAndPassword(auth, email, password);
                    console.log("Account created and signed in successfully.");
                } else {
                    await signInWithEmailAndPassword(auth, email, password);
                    console.log("Signed in successfully.");
                }
                hideAuthModal();
            } catch (error) {
                let errorMessage = error.message;
                if (error.code === 'auth/email-already-in-use') {
                    errorMessage = 'This email is already in use. Try signing in.';
                } else if (error.code === 'auth/invalid-email') {
                    errorMessage = 'The email address is not valid.';
                } else if (error.code === 'auth/weak-password') {
                    errorMessage = 'Password should be at least 6 characters.';
                } else if (error.code === 'auth/user-not-found' || error.code === 'auth/wrong-password') {
                    errorMessage = 'Invalid email or password.';
                }
                showAuthError(errorMessage);
            }
        }

        async function handleGoogleSignIn() {
            if (!auth) {
                showAuthError("Firebase is not initialized.");
                return;
            }
            try {
                const provider = new GoogleAuthProvider();
                // Since the environment is an iframe, using signInWithPopup is safer than redirect.
                await signInWithPopup(auth, provider);
                hideAuthModal();
                console.log("Signed in with Google successfully.");
            } catch (error) {
                console.error("Google sign-in failed:", error);
                showAuthError("Google Sign-In failed. Please try again.");
            }
        }

        async function handleSignOut() {
            if (auth) {
                try {
                    await signOut(auth);
                    // Sign in anonymously again to maintain session context
                    await signInAnonymously(auth); 
                    console.log("Signed out and switched to anonymous.");
                    navigateTo('home');
                } catch (error) {
                    console.error("Sign out failed:", error);
                }
            }
        }

        function showAuthError(message) {
            authErrorDiv.textContent = message;
            authErrorDiv.classList.remove('hidden');
        }

        // --------------------------------------------------------------------------------
        // PURCHASE & SUBSCRIPTION HANDLERS
        // --------------------------------------------------------------------------------

        /**
         * Unified handler for service action buttons (Buy Now or Get Quote)
         */
        function handleServiceActionUnified(event) {
            const button = event.currentTarget;
            const actionType = button.getAttribute('data-action-type');
            const serviceName = button.getAttribute('data-service-name');
            const stripeLink = button.getAttribute('data-link');

            if (!isLoggedIn) {
                showAuthModal("Please sign in to proceed with this service.");
                return;
            }

            if (actionType === 'purchase' && stripeLink) {
                // Redirect to Stripe checkout
                window.open(stripeLink, '_blank');
            } else if (actionType === 'quote') {
                // Handle quote request (could open a contact form or modal)
                alert(`Quote requested for: ${serviceName}\n\nPlease contact us via email or our contact form to discuss your project requirements.`);
            }
        }

        /**
         * Handler for subscription plan purchase buttons
         */
        function handleSubscriptionAttempt(event) {
            const button = event.currentTarget;
            const planName = button.getAttribute('data-plan-name');
            const stripeLink = button.getAttribute('data-link');

            if (!isLoggedIn) {
                showAuthModal("Please sign in to subscribe to a plan.");
                return;
            }

            if (stripeLink) {
                // Redirect to Stripe checkout
                window.open(stripeLink, '_blank');
            } else {
                alert(`Starting ${planName} subscription...\n\nPlease contact us to complete your subscription setup.`);
            }
        }

        // --------------------------------------------------------------------------------
        // VIEW SWITCHING LOGIC (Multipage Simulation)
        // --------------------------------------------------------------------------------

        /**
         * Switches the displayed content section and updates the active navigation link.
         * @param {string} targetId - The ID of the section to display (e.g., 'home', 'services').
         */
        function navigateTo(targetId) {
            // 1. Hide all content sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.add('hidden');
            });

            // 2. Show the target section
            const targetSection = document.getElementById(targetId);
            if (targetSection) {
                targetSection.classList.remove('hidden');
                // Scroll to the top of the main container for a "fresh page" feel
                document.querySelector('main').scrollTo(0, 0);
            } else {
                console.error(`Attempted to navigate to unknown page ID: ${targetId}`);
            }

            // 3. Update active state of navigation links
            document.querySelectorAll('.nav-link').forEach(link => {
                if (link.getAttribute('data-target') === targetId) {
                    link.classList.add('active');
                } else {
                    link.classList.remove('active');
                }
            });
            
            // Close mobile menu if open
            const mobileMenu = document.getElementById('mobile-menu');
            if (!mobileMenu.classList.contains('hidden')) {
                mobileMenu.classList.add('hidden');
            }
        }

        // --------------------------------------------------------------------------------
        // DATA STRUCTURES (EXPANDED CODING SERVICES WITH STRIPE LINKS)
        // --------------------------------------------------------------------------------
        
        // UPDATED: Added stripeLink to all fixed-price services
        const allServices = [
    // --- Web Frontend ---
    { id: 1, name: "Responsive Static Website", description: "Full implementation of a modern, fast static site using HTML/CSS/JS.", category: "Web Frontend", tags: ["HTML", "CSS", "JavaScript", "Frontend", "Static"], icon: "monitor", price: "$29.99", stripeLink: "https://buy.stripe.com/cNicN52L06H6cMveTk9EI1D" },
    { id: 2, name: "React Component Development", description: "Building reusable, optimized components with React and functional hooks.", category: "Web Frontend", tags: ["React", "JavaScript", "Frontend", "Components"], icon: "layout-grid", price: "$35.00", stripeLink: "https://buy.stripe.com/6oUbJ1gBQ6H65k34eG9EI1B" },
    { id: 3, name: "Angular Module Development", description: "Developing structured modules and components using the Angular framework.", category: "Web Frontend", tags: ["Angular", "TypeScript", "Modules", "Frontend"], icon: "git-fork", price: "$25.00", stripeLink: "https://buy.stripe.com/aFa7sL0CSaXm5k326y9EI1C" },
    { id: 4, name: "Tailwind CSS Integration", description: "Implementing utility-first styling for rapid, responsive UI design.", category: "Web Frontend", tags: ["Tailwind", "CSS", "Frontend", "Styling"], icon: "palette", price: "$15.00", stripeLink: "https://buy.stripe.com/28EfZh71gaXm7sb7qS9EI1A" },
    { id: 5, name: "State Management Implementation (Redux/Zustand)", description: "Setting up efficient, predictable state management solutions.", category: "Web Frontend", tags: ["Redux", "Zustand", "React", "State Management"], icon: "pocket", price: "$50.00", stripeLink: "https://buy.stripe.com/28E9ATfxMfdC6o726y9EI1z" },
    { id: 6, name: "Progressive Web App (PWA) Setup", description: "Enabling offline capabilities and installability for web applications.", category: "Web Frontend", tags: ["PWA", "Web App", "Offline", "Frontend"], icon: "smartphone", price: "$100.00", stripeLink: "https://buy.stripe.com/5kQ3cv99o8PeeUDdPg9EI1y" },
    { id: 7, name: "Custom JavaScript Utility Libraries", description: "Writing modular, highly optimized vanilla JavaScript functions.", category: "Web Frontend", tags: ["JavaScript", "Library", "Optimization"], icon: "activity", price: "$50.00", stripeLink: "https://buy.stripe.com/5kQ00jbhw8PefYHbH89EI1x" },
    { id: 8, name: "Web Accessibility (A11y) Audit & Fixes", description: "Ensuring WCAG compliance for an inclusive user experience.", category: "Web Frontend", tags: ["Accessibility", "A11y", "Frontend", "WCAG"], icon: "eye", price: "$199.00", stripeLink: "https://buy.stripe.com/eVq5kDetI2qQaEnfXo9EI1w" },
    { id: 9, name: "Next.js/Gatsby Static Site Generation (SSG)", description: "Building highly performant, SEO-friendly static sites using modern frameworks.", category: "Web Frontend", tags: ["Next.js", "Gatsby", "Static Site", "Frontend"], icon: "cpu", price: "$70.00", stripeLink: "https://buy.stripe.com/fZu7sL0CSc1qfYH9z09EI1v" },
    { id: 10, name: "Web Performance Optimization (Core Web Vitals)", description: "Improving loading speed, interactivity, and visual stability for high scores.", category: "Web Frontend", tags: ["Performance", "SEO", "Core Web Vitals"], icon: "zap", price: "$49.00", stripeLink: "https://buy.stripe.com/aFa8wP99o2qQ3bVfXo9EI1u" },
    { id: 11, name: "Advanced CSS/SVG Animation (GSAP/Framer)", description: "Creating smooth, complex motion graphics and interactive UI elements.", category: "Web Frontend", tags: ["Animation", "CSS", "SVG", "GSAP", "Framer"], icon: "sparkles", price: "$100.00", stripeLink: "https://buy.stripe.com/8x26oH85k7La3bVaD49EI1t" },
    { id: 12, name: "Cross-Browser Compatibility Testing", description: "Ensuring consistent functionality and display across all major browsers.", category: "Web Frontend", tags: ["Testing", "Cross-Browser", "Compatibility"], icon: "globe", price: "$40.00", stripeLink: "https://buy.stripe.com/00w14n0CS6H63bVcLc9EI1s" },
    { id: 13, name: "Component Library Development (Storybook)", description: "Creating a centralized, documented system for UI component design.", category: "Web Frontend", tags: ["Storybook", "UI Library", "Documentation"], icon: "book-open", price: "$349", stripeLink: "https://buy.stripe.com/00w9AT4T8d5ubIr7qS9EI1r" },

    // --- Backend & API ---
    { id: 14, name: "Node.js/Express API Development", description: "Building fast and scalable RESTful APIs using the Node.js ecosystem.", category: "Web Backend", tags: ["Node.js", "Express", "API", "Backend"], icon: "server", price: "$100", stripeLink: "https://buy.stripe.com/8x27sL85kghGfYH4eG9EI1q" },
    { id: 15, name: "Python/Django Backend Development", description: "Creating robust, secure web backends with Django or Flask.", category: "Web Backend", tags: ["Python", "Django", "Flask", "Backend"], icon: "terminal", price: "$120", stripeLink: "https://buy.stripe.com/7sY00jclA5D2bIrcLc9EI1p" },
    { id: 16, name: "Microservice Architecture Design", description: "Breaking down monolithic applications into scalable, independent services.", category: "Web Backend", tags: ["Microservices", "Architecture", "Backend"], icon: "hexagon", price: "$500", stripeLink: "https://buy.stripe.com/fZucN52L05D24fZcLc9EI1o" },
    { id: 17, name: "GraphQL Endpoint Implementation", description: "Developing efficient data querying layers with GraphQL.", category: "Web Backend", tags: ["GraphQL", "API", "Backend"], icon: "link", price: "$75", stripeLink: "https://buy.stripe.com/cNi28r71g7La9AjbH89EI1n" },
    { id: 18, name: "Serverless Function Deployment (AWS Lambda/Firebase)", description: "Setting up event-driven serverless backends for cost efficiency.", category: "Web Backend", tags: ["Serverless", "AWS", "Firebase"], icon: "cloud", price: "$70", stripeLink: "https://buy.stripe.com/14A8wPbhw7La13N8uW9EI1m" },
    { id: 19, name: "Authentication and Authorization Setup (OAuth/JWT)", description: "Implementing secure user login and role-based access control.", category: "Web Backend", tags: ["OAuth", "JWT", "Auth", "Security"], icon: "lock", price: "$50", stripeLink: "https://buy.stripe.com/3cI6oHetI6H6fYHcLc9EI1l" },
    { id: 20, name: "Third-Party API Integration", description: "Connecting your system to external services (e.g., payment, weather, map APIs).", category: "Web Backend", tags: ["API", "Integration", "Backend"], icon: "plug", price: "$199", stripeLink: "https://buy.stripe.com/7sY14netI0iI4fZcLc9EI1k" },
    { id: 21, name: "(Currently Not Available) Real-time Communication (WebSockets)", description: "Implementing live updates and chat functionality.", category: "Web Backend", tags: ["WebSockets", "Realtime", "Chat"], icon: "message-square", price: "Not Available", stripeLink: null },
    { id: 22, name: "API Documentation (Swagger/OpenAPI)", description: "Creating clear, interactive documentation for your endpoints.", category: "Web Backend", tags: ["Swagger", "OpenAPI", "Docs"], icon: "book-open", price: "$50", stripeLink: "https://buy.stripe.com/8x25kDclA7La13NeTk9EI1j" },

    // --- Database ---
    { id: 23, name: "SQL Database Design & Normalization", description: "Designing optimal schemas for PostgreSQL, MySQL, or SQL Server.", category: "Database", tags: ["SQL", "PostgreSQL", "MySQL", "Schema"], icon: "database", price: "$199", stripeLink: "https://buy.stripe.com/9B6cN5clAghGcMvcLc9EI1i" },
    { id: 24, name: "NoSQL Schema Design (MongoDB/Firebase)", description: "Structuring flexible and performant NoSQL data models.", category: "Database", tags: ["NoSQL", "MongoDB", "Firebase"], icon: "layers", price: "$100", stripeLink: "https://buy.stripe.com/bJe00jclA5D26o79z09EI1h" },
    { id: 25, name: "ETL Pipeline Development", description: "Building data extraction, transformation, and loading processes.", category: "Database", tags: ["ETL", "Data", "Pipeline"], icon: "box", price: "$155", stripeLink: "https://buy.stripe.com/fZu6oH1GW0iI3bVaD49EI1g" },

    // --- Mobile ---
    { id: 26, name: "React Native Feature Implementation", description: "Adding cross-platform features to existing or new React Native apps.", category: "Mobile", tags: ["React Native", "Mobile", "Cross Platform"], icon: "app-window", price: "$100", stripeLink: "https://buy.stripe.com/8x228r71g4yY5k3cLc9EI1d" },
    { id: 27, name: "Flutter UI/Logic Development", description: "Building beautiful and performant mobile UIs with Flutter (Dart).", category: "Mobile", tags: ["Flutter", "Dart", "UI", "Mobile"], icon: "tablet", price: "$299", stripeLink: "https://buy.stripe.com/3cI28r71g9Tih2Lh1s9EI1e" },
    { id: 28, name: "Mobile Push Notification Setup", description: "Integrating Firebase Cloud Messaging (FCM) or similar services.", category: "Mobile", tags: ["Notifications", "Mobile", "Firebase"], icon: "bell", price: "$199", stripeLink: "https://buy.stripe.com/cNi8wPbhwghG27R8uW9EI1f" },

    // --- Game Development ---
    { id: 29, name: "Unity Engine 2D/3D Scene Setup", description: "Initial scene, camera, and asset integration in the Unity environment. (Assets must be provided by client.)", category: "Game Dev", tags: ["Unity", "C#", "2D", "3D", "Game"], icon: "gamepad-2", price: "$200", stripeLink: "https://buy.stripe.com/4gM4gzclA4yY3bV7qS9EI1c" },
    { id: 30, name: "C# Game Logic Scripting", description: "Writing core game mechanics and systems in optimized C# scripts.", category: "Game Dev", tags: ["Unity", "C#", "Game Logic"], icon: "code", price: "$299", stripeLink: "https://buy.stripe.com/6oU3cvgBQ5D2fYH6mO9EI1b" },
    { id: 31, name: "Basic Multiplayer Networking Setup", description: "Implementing simple peer-to-peer or server-authoritative connections.", category: "Game Dev", tags: ["Networking", "Multiplayer", "Unity"], icon: "users", price: "$500", stripeLink: "https://buy.stripe.com/fZubJ1fxMfdC5k3eTk9EI1a" },

    // --- Consulting ---
    { id: 32, name: "Technical Consulting Session", description: "One-on-one session for technical roadmap planning and architecture guidance.", category: "Consulting", tags: ["Consulting", "Architecture", "Planning"], icon: "brain", price: "FREE", stripeLink: "https://buy.stripe.com/00w14nclAghGfYH5iK9EI19" },
    { id: 33, name: "In-Depth Code Review & Refactoring", description: "Thorough review for best practices, security, and performance improvements.", category: "Consulting", tags: ["Code Review", "Security", "Optimization"], icon: "file-check", price: "$30 / Hour", stripeLink: "https://buy.stripe.com/5kQdR94T85D27sbdPg9EI18" },
    { id: 34, name: "Security Vulnerability Patching", description: "Addressing common security issues like XSS, CSRF, and SQL injection.", category: "Consulting", tags: ["Security", "Vulnerability", "Fix"], icon: "bug", price: "$50 / hour", stripeLink: "https://mock-stripe.com/buy/rvo-security-299" }
];

        
        const subscriptionPlans = [
            { 
                name: "Silver VIP (Starter)", 
                price: 15000, 
                description: "Perfect for MVPs and small projects. Includes 40 hours of development per month.", 
                features: ["40 Dev Hours/Mo", "Basic Code Review", "Email Support", "1 Active Project"], 
                icon: "zap", 
                color: "text-green-400", 
                tagline: "Minimum Viable Product",
                stripeLink: "https://buy.stripe.com/4gMaEXbhwc1q9AjfXo9EI16"
            },
            { 
                name: "Gold VIP (Professional)", 
                price: 40000, 
                description: "Our most popular plan. Ideal for growing businesses needing dedicated support.", 
                features: ["160 Dev Hours/Mo", "Dedicated Team Lead", "Priority Support (Slack)", "2 Active Projects", "CI/CD Setup"], 
                icon: "trending-up", 
                color: "text-red-400", 
                isFeatured: true,
                tagline: "Dedicated Support Team",
                stripeLink: "https://buy.stripe.com/5kQfZh99o9Ti8wf7qS9EI15"
            },
            { 
                name: "Platinum VIP (Enterprise)", 
                price: 105000, 
                description: "Full-scale solution for complex, mission-critical projects and large teams.", 
                features: ["320 Dev Hours/Mo", "Vary Fast Premium Support (Less then 5 Hours During Off Hours)", "On-demand Scaling", "Unlimited Projects"], 
                icon: "shield", 
                color: "text-blue-400", 
                tagline: "Scalable Mission-Critical",
                stripeLink: "https://buy.stripe.com/bJeeVd0CS1mM8wffXo9EI14"
            },
        ];

        // --------------------------------------------------------------------------------
        // DYNAMIC CONTENT RENDERING AND PURCHASE LOGIC
        // --------------------------------------------------------------------------------
// ---------- Simple, robust discount applicator (no colors) ----------
const DISCOUNT_PERCENT = 50; // change this value to edit the discount

function applyDiscountToServices(services) {
  services.forEach(s => {
    const p = s.price;

    // If price is a string that contains a dollar sign, try parse a number
    if (typeof p === "string" && p.includes("$")) {
      const num = parseFloat(p.replace(/[^0-9.]/g, ""));
      if (!isNaN(num)) {
        const discounted = +(num * (1 - DISCOUNT_PERCENT / 100));
        s.displayPrice = `<span style="text-decoration: line-through; opacity: 0.6;">$${num.toFixed(2)}</span>
                           <span style="font-weight:600; margin-left:6px;"> ${DISCOUNT_PERCENT}% OFF → $${discounted.toFixed(2)}</span>`;
      } else {
        // preserve text like "FREE" or unexpected formats
        s.displayPrice = p;
      }

    } else if (typeof p === "number") {
      // If someone used a number (assume dollars)
      const discounted = +(p * (1 - DISCOUNT_PERCENT / 100));
      s.displayPrice = `<span style="text-decoration: line-through; opacity: 0.6;">$${p.toFixed(2)}</span>
                         <span style="font-weight:600; margin-left:6px;"> ${DISCOUNT_PERCENT}% OFF → $${discounted.toFixed(2)}</span>`;
    } else {
      // fallback for NOT available, null, or other types
      s.displayPrice = p ?? "N/A";
    }
  });
}

function applyDiscountToPlans(plans) {
  plans.forEach(plan => {
    const p = plan.price;

    // Your plans use cents (e.g. 15000 = $150.00). Only treat numeric plan.price as cents.
    if (typeof p === "number") {
      const originalDollars = p / 100;
      const discounted = +(originalDollars * (1 - DISCOUNT_PERCENT / 100));
      plan.displayPrice = `<span style="text-decoration: line-through; opacity: 0.6;">$${originalDollars.toFixed(2)}</span>
                           <span style="font-weight:600; margin-left:6px;"> ${DISCOUNT_PERCENT}% OFF → $${discounted.toFixed(2)}</span>`;
    } else if (typeof p === "string" && p.includes("$")) {
      // In case any plan used a dollar string instead of cents
      const num = parseFloat(p.replace(/[^0-9.]/g, ""));
      if (!isNaN(num)) {
        const discounted = +(num * (1 - DISCOUNT_PERCENT / 100));
        plan.displayPrice = `<span style="text-decoration: line-through; opacity: 0.6;">$${num.toFixed(2)}</span>
                             <span style="font-weight:600; margin-left:6px;"> ${DISCOUNT_PERCENT}% OFF → $${discounted.toFixed(2)}</span>`;
      } else {
        plan.displayPrice = p;
      }
    } else {
      plan.displayPrice = p ?? "N/A";
    }
  });
}

// Run the functions (make sure this runs after arrays are defined)
applyDiscountToServices(allServices);
applyDiscountToPlans(subscriptionPlans);

// Optional quick debug to confirm values (open browser console)
console.log("example service displayPrice:", allServices[0]?.displayPrice);
console.log("example plan displayPrice:", subscriptionPlans[0]?.displayPrice);


        /**
         * Renders the list of services based on current search and filter criteria.
         */
        function renderServices(servicesToRender) {
            const serviceList = document.getElementById('service-list');
            const noResults = document.getElementById('no-results');
            serviceList.innerHTML = '';
            
            if (servicesToRender.length === 0) {
                noResults.classList.remove('hidden');
            } else {
                noResults.classList.add('hidden');
            }

            servicesToRender.forEach(service => {
                
                const isFixedPrice = service.price && !service.price.toLowerCase().includes('quote') && !service.price.toLowerCase().includes('hour');
                
                // Determine button properties
                const actionType = isFixedPrice ? 'purchase' : 'quote';
                const baseButtonText = isFixedPrice ? 'Buy Now' : 'Get Quote';
                const loginPrefix = isFixedPrice ? 'Buy' : 'Quote';

                const buttonText = isLoggedIn ? baseButtonText : `Log In to ${loginPrefix}`;
                const buttonClasses = isLoggedIn 
                    ? 'bg-red-700 hover:bg-red-600'
                    : 'bg-gray-700 text-gray-400 cursor-not-allowed';

                const buttonAttributes = isFixedPrice 
                    ? `data-link="${service.stripeLink}" data-service-name="${service.name}"` 
                    : `data-service-name="${service.name}"`;


                const tagsHtml = service.tags.map(tag => 
                    `<span class="inline-block bg-gray-700 text-gray-300 text-xs px-3 py-1 rounded-full">${tag}</span>`
                ).join('');

                const cardHtml = `
                    <div class="card-bg p-6 rounded-xl shadow-xl transition duration-300 hover:shadow-red-900/50 hover:border-red-500 flex flex-col">
                        <div class="flex items-center mb-4">
                            <i data-lucide="${service.icon}" class="w-8 h-8 ${service.color || 'text-red-500'} mr-3"></i>
                            <h3 class="text-xl font-bold text-white">${service.name}</h3>
                        </div>
                        <p class="text-gray-400 mb-4 flex-grow">${service.description}</p>
                        <div class="flex flex-wrap gap-2 mb-4">
                            ${tagsHtml}
                        </div>
                        <div class="mt-auto pt-4 border-t border-gray-700 flex justify-between items-center">
                            <span class="text-lg font-semibold text-red-400">${service.price}</span>
                            <button class="service-action-btn px-4 py-2 text-sm font-semibold rounded-lg ${buttonClasses} text-white transition duration-300"
                                data-action-type="${actionType}"
                                ${buttonAttributes}
                                ${isLoggedIn ? '' : 'title="You must sign in to proceed"'}
                            >
                                ${buttonText}
                            </button>
                        </div>
                    </div>
                `;
                serviceList.insertAdjacentHTML('beforeend', cardHtml);
            });
            
            // Attach unified event listener for all service action buttons
            document.querySelectorAll('.service-action-btn').forEach(button => {
                // Clear old listeners before adding new ones
                button.removeEventListener('click', handleServiceActionUnified); 
                button.addEventListener('click', handleServiceActionUnified);
            });
            
            // Re-initialize Lucide icons for newly added elements
            lucide.createIcons();
        }

        /**
         * Filters the allServices array based on search text and selected category.
         */
        function filterServices() {
            const searchText = document.getElementById('service-search').value.toLowerCase();
            const filterCategory = document.getElementById('service-filter').value;

            const filteredServices = allServices.filter(service => {
                const matchesSearch = service.name.toLowerCase().includes(searchText) ||
                                      service.description.toLowerCase().includes(searchText) ||
                                      service.tags.some(tag => tag.toLowerCase().includes(searchText));
                
                const matchesCategory = filterCategory === 'all' || service.category === filterCategory;

                return matchesSearch && matchesCategory;
            });

            renderServices(filteredServices);
        }

        /**
         * Populates the filter dropdown with unique categories.
         */
        function populateCategoryFilter() {
            const filterSelect = document.getElementById('service-filter');
            const categories = [...new Set(allServices.map(service => service.category))];
            
            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = category;
                filterSelect.appendChild(option);
            });
            
            // Add event listeners for filtering
            document.getElementById('service-search').addEventListener('input', filterServices);
            document.getElementById('service-filter').addEventListener('change', filterServices);
        }

        /**
         * Renders the subscription plans grid.
         */
        function renderSubscriptions(plans) {
            const subscriptionPlansDiv = document.getElementById('subscription-plans');
            subscriptionPlansDiv.innerHTML = '';

            plans.forEach(plan => {
                const isFeatured = plan.isFeatured ? 'border-red-500 ring-4 ring-red-900/50' : 'border-gray-700';
                
                // Determine button state based on current auth status
                const buttonText = isLoggedIn ? `Start ${plan.name} Plan` : 'Log In to Subscribe';
                const buttonColor = isLoggedIn 
                    ? (plan.isFeatured ? 'bg-red-700 hover:bg-red-600' : 'card-bg hover:bg-gray-700 border border-red-700 text-red-400')
                    : 'bg-gray-700 text-gray-400 cursor-not-allowed'; // Grayed out if not logged in
                
                const featuresHtml = plan.features.map(feature => 
                    `<li class="flex items-center text-gray-300 mb-2">
                        <i data-lucide="check" class="w-4 h-4 mr-2 text-green-500 flex-shrink-0"></i>
                        ${feature}
                    </li>`
                ).join('');

                const planHtml = `
                    <div class="card-bg p-8 rounded-xl shadow-2xl transition duration-300 hover:shadow-red-900/70 border-2 ${isFeatured} flex flex-col">
                        <div class="mb-6">
                            <p class="text-sm font-semibold uppercase ${plan.color}">${plan.tagline}</p>
                            <h3 class="text-3xl font-bold text-white mt-1">${plan.name}</h3>
                            <p class="text-gray-400 mt-2">${plan.description}</p>
                        </div>
                        <div class="text-4xl font-extrabold text-white mb-6">
                            $${(plan.price / 100).toFixed( plan.price % 100 === 0 ? 0 : 2)}
                            <span class="text-lg font-medium text-gray-500">/mo</span>
                        </div>
                        
                        <ul class="flex-grow mb-8">
                            ${featuresHtml}
                        </ul>
                        
                        <button 
                            class="purchase-btn w-full py-3 font-semibold rounded-xl ${buttonColor} text-white transition duration-300"
                            data-link="${plan.stripeLink}" 
                            data-plan-name="${plan.name}"
                            ${isLoggedIn ? '' : 'title="You must sign in to subscribe"'}
                        >
                            ${buttonText}
                        </button>
                    </div>
                `;
                subscriptionPlansDiv.insertAdjacentHTML('beforeend', planHtml);
            });
            
            // Attach event listeners to the new buttons
            document.querySelectorAll('.purchase-btn').forEach(button => {
                button.removeEventListener('click', handleSubscriptionAttempt);
                button.addEventListener('click', handleSubscriptionAttempt);
            });
            
            lucide.createIcons();
        }

        // --------------------------------------------------------------------------------
        // AFFILIATE MODAL & DISCORD WEBHOOK FUNCTIONS
        // --------------------------------------------------------------------------------

        // Discord Webhook URL - Replace with your actual webhook URL
        const DISCORD_WEBHOOK_URL = 'YOUR_DISCORD_WEBHOOK_URL_HERE';

        const affiliateModal = document.getElementById('affiliate-modal');
        const affiliateForm = document.getElementById('affiliate-form');
        const affiliateError = document.getElementById('affiliate-error');
        const successPopup = document.getElementById('success-popup');

        function showAffiliateModal() {
            // Check if user is logged in
            if (!isLoggedIn) {
                showAuthModal("Please sign in to join our affiliate program.");
                return;
            }
            
            affiliateModal.classList.remove('hidden');
            lucide.createIcons(); // Refresh icons for the help-circle icon
        }

        function hideAffiliateModal() {
            affiliateModal.classList.add('hidden');
            affiliateForm.reset();
            affiliateError.classList.add('hidden');
        }

        function showSuccessPopup() {
            successPopup.classList.remove('hidden');
            lucide.createIcons(); // Refresh icons for the check-circle icon
        }

        function hideSuccessPopup() {
            successPopup.classList.add('hidden');
        }

        function showAffiliateError(message) {
            affiliateError.textContent = message;
            affiliateError.classList.remove('hidden');
        }

        function validateAffiliateCode(code) {
            // Must be lowercase alphabetical with optional hyphens, no other special chars, max 14 chars
            const regex = /^[a-z\-]{1,14}$/;
            if (!regex.test(code)) {
                return false;
            }
            // Additional check: no underscores, dots, or other special characters
            if (code.includes('_') || code.includes('.')) {
                return false;
            }
            return true;
        }

        async function submitAffiliateForm(event) {
            event.preventDefault();
            affiliateError.classList.add('hidden');

            // Collect form data
            const formData = {
                preferredName: document.getElementById('affiliate-name').value.trim(),
                discordName: document.getElementById('affiliate-discord-name').value.trim(),
                discordId: document.getElementById('affiliate-discord-id').value.trim(),
                email: document.getElementById('affiliate-email').value.trim(),
                phone: document.getElementById('affiliate-phone').value.trim() || 'Not provided',
                company: document.getElementById('affiliate-company').value.trim() || 'Not provided',
                affiliateCode: document.getElementById('affiliate-code').value.trim().toLowerCase(),
                followers: document.getElementById('affiliate-followers').value,
                platform: document.getElementById('affiliate-platform').value,
                profileLink: document.getElementById('affiliate-profile-link').value.trim(),
                expectedReferrals: document.getElementById('affiliate-referrals').value,
                notificationPreference: document.getElementById('affiliate-notification').value,
                geographic: document.getElementById('affiliate-geo').value.trim(),
                experience: document.getElementById('affiliate-experience').value,
                compliance: document.getElementById('affiliate-compliance').checked
            };

            // Validate affiliate code
            if (!validateAffiliateCode(formData.affiliateCode)) {
                showAffiliateError('Invalid affiliate code format. Use only lowercase letters and hyphens (-). No underscores, dots, or other special characters. Max 14 characters.');
                return;
            }

            // Validate Discord ID format
            if (!/^[0-9]{17,19}$/.test(formData.discordId)) {
                showAffiliateError('Invalid Discord ID format. Please enter a valid Discord ID (17-19 digits).');
                return;
            }

            // Disable submit button during submission
            const submitBtn = document.getElementById('affiliate-submit');
            const originalText = submitBtn.textContent;
            submitBtn.disabled = true;
            submitBtn.textContent = 'Submitting...';

            try {
                // Create Discord embed message
                const discordPayload = {
                    embeds: [{
                        title: '🎉 New Affiliate Application',
                        color: 0xDC143C, // Crimson red
                        fields: [
                            { name: '👤 Preferred Name', value: formData.preferredName, inline: true },
                            { name: '💬 Discord Name', value: formData.discordName, inline: true },
                            { name: '🆔 Discord ID', value: formData.discordId, inline: true },
                            { name: '📧 Email', value: formData.email, inline: true },
                            { name: '📱 Phone', value: formData.phone, inline: true },
                            { name: '🏢 Company', value: formData.company, inline: true },
                            { name: '🔖 Desired Code', value: `\`${formData.affiliateCode}\``, inline: false },
                            { name: '👥 Followers', value: formData.followers, inline: true },
                            { name: '📱 Platform', value: formData.platform, inline: true },
                            { name: '🔗 Profile Link', value: formData.profileLink, inline: false },
                            { name: '📊 Expected Referrals/Mo', value: formData.expectedReferrals, inline: true },
                            { name: '🔔 Notification Pref', value: formData.notificationPreference, inline: true },
                            { name: '🌍 Geographic Focus', value: formData.geographic, inline: true },
                            { name: '⭐ Experience Level', value: formData.experience, inline: true },
                            { name: '✅ Guidelines Accepted', value: formData.compliance ? 'Yes' : 'No', inline: true }
                        ],
                        timestamp: new Date().toISOString(),
                        footer: {
                            text: 'RVO Inc. Affiliate System'
                        }
                    }]
                };

                // Send to Discord webhook
                const response = await fetch(DISCORD_WEBHOOK_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(discordPayload)
                });

                if (!response.ok) {
                    throw new Error('Failed to submit application');
                }

                // Success!
                hideAffiliateModal();
                showSuccessPopup();

            } catch (error) {
                console.error('Error submitting affiliate form:', error);
                showAffiliateError('Failed to submit application. Please check that the Discord webhook is configured correctly, or try again later.');
            } finally {
                // Re-enable submit button
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            }
        }


        // --------------------------------------------------------------------------------
        // EVENT LISTENERS AND INITIALIZATION
        // --------------------------------------------------------------------------------

        document.addEventListener('DOMContentLoaded', () => {
            setupFirebase();

            // Set initial active nav link
            navigateTo('home');
            
            // Populate filter options
            populateCategoryFilter();
            
            // Navigation event listeners (for both desktop and mobile menu)
            document.querySelectorAll('.nav-link, .navigate-link').forEach(button => {
                button.addEventListener('click', (event) => {
                    const target = event.currentTarget.getAttribute('data-target');
                    if (target) {
                        navigateTo(target);
                    }
                });
            });

            // Mobile menu toggle
            document.getElementById('mobile-menu-btn').addEventListener('click', () => {
                document.getElementById('mobile-menu').classList.toggle('hidden');
            });
            
            // Auth modal actions
            document.getElementById('close-modal').addEventListener('click', hideAuthModal);
            authSubmitBtn.addEventListener('click', handleAuthAction);
            logoutBtn.addEventListener('click', handleSignOut);
            
            // Toggle between Sign In and Sign Up modes
            authToggleBtn.addEventListener('click', () => {
                isSigningUp = !isSigningUp;
                updateAuthModalUI();
                authErrorDiv.classList.add('hidden');
            });

            // Google Sign In
            document.getElementById('google-signin').addEventListener('click', handleGoogleSignIn);

            // Affiliate modal event listeners
            document.getElementById('open-affiliate-modal').addEventListener('click', showAffiliateModal);
            document.getElementById('close-affiliate-modal').addEventListener('click', hideAffiliateModal);
            affiliateForm.addEventListener('submit', submitAffiliateForm);
            document.getElementById('close-success-popup').addEventListener('click', hideSuccessPopup);
        });

        // Re-initialize Lucide on window load to catch static elements
        window.onload = function() {
            lucide.createIcons();
        };

    </script>
</body>
</html>
